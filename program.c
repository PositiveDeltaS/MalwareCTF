#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <string.h>
#define USERDEF "AAAAAA"

char msg[] = \
"This binary is a little nasty and doesn't even prompt for password input before\n\
failing the user with a 'Try again.' To solve this level, flex your GDB muscles \n\
to skip into code past the pre-emptive return. After that, make sure your password\n\
input isn't overwritten by this rude program and continue on to find the function\n\
that contains the string comparison.\n\n";  


void print_good() {
    printf("Good Job.\n");
    exit(0);
}
int two(char * userinput) {
    if(strcmp(USERDEF, userinput) == 0)
      return 1;
    else
      return 0;
}
int one() {
  char buff[20];
  char pass[20];
  int i;
  for (i=0; i < 20; i++)
    pass[i] = 0;
  strncpy(pass,USERDEF,strlen(USERDEF));

  printf("Enter the password: ");
  scanf("%8s",buff);
  strcpy(buff, "erased!");
  return two(buff);
}
void three() {
   int x = 1;
   if(x == 1)
     return;
   if(one()) {
     print_good();
     exit(0);
   }
}
void print_msg() {
        printf("%s",msg);
}
int main () {
    printf(USERDEF);
    print_msg();
    three();
    printf("Try again.\n");
    return 0;
}
